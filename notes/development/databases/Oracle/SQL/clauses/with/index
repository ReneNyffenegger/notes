$ Oracle SQL: WITH clause
@ with clause

In an → development/databases/Oracle/SQL/statement, a *with clause* allows to define
  • (named) subquery blocks, or
  • → development/databases/Oracle/PL-SQL procedures and functions.

{ Local functions #ora-with-func

  A `with` clause allows to declare → development/databases/Oracle/PL-SQL functions that are local to the → development/databases/Oracle/SQL/statement in which it occurs:
code {
with
   function f (a number, b number) return number is
   begin
      return abs(a) + abs(b);
   end f;
   function g (a number, b number) return number is
   begin
      return f(a-5, b+5);
   end g;
   d as (
     select -4 u,  9 v from dual union all
     select  4 u,  9 v from dual union all
     select -2 u, -8 v from dual union all
     select  1 u,  0 v from dual
   )
select
   u,
   v,
   f(u,v) f,
   g(u,v) g
from
   d
;
code }

  Another example …
  gh|Oracle-Patterns|/SQL/select/with/inline-function/example-01.sql||

  See also → development/databases/Oracle/PL-SQL/pragma/inline[`pragma inline`].

}
{ Combining WITH clause with UNION ALL #ora-with-union-all

  The following somewhat silly select statement demonstrates how a `WITH` clause can be combined with a → development/databases/Oracle/SQL/select/set-operators/union/all[`UNION ALL`]:
code {
with p as (select 'FOO' nam from dual)
   select 'object', owner      from p, dba_objects      where object_name = p.nam union all
   select 'column', table_name from p, dba_tab_columns  where column_name = p.nam;
code }

}

sa:


  In a `with` clause, the → development/databases/Oracle/SQL/hints[`/*+ materialize */` hint] forces the data that is returned by its → development/databases/Oracle/SQL/select/subquery to be stored
  in a → development/databases/Oracle/objects/tables/types/global-temporary[global temporary table].

  Using a `with` clause in a → development/databases/Oracle/SQL/statement/nouns/table/create/as-select#ora-ctas-with[`create table as select` statement].

  The *cursor duration temporary tables* → development/databases/Oracle/optimizer#ora-optimizer-qry-tran[query transformation].

  → development/databases/Oracle/errors/ORA-32034_unsupported-use-of_WITH-clause
