$ ORA-04031: unable to allocate … bytes of shared memory

The *ORA-04031 unable to allocate … bytes of shared memory* might cause some irritation when it reports that a (relatively small) amount of memory cannot be allocated even though
there is plenty of free memory in the System.
-
This is because the → development/databases/Oracle/architecture/instance/SGA/Shared-Pool#ora-shared-pool-alloc-mem[Shared pool heap manager] allocates *contiguous* memory and the largest chunk
of contiguous memory might be well below the total amount of free memory.

An ORA-04031 error is often related to
  • the value of `→ development/databases/Oracle/adminstration/init-parameters/shared/pool/size` and/or
  • the database not finding large enough chunks of memory because of fragmentation

The most obvious fix for ORA-04031 errors is to increase the size of the → development/databases/Oracle/architecture/instance/SGA/Shared-Pool. When doing that, it might be useful to
consult `v$shared_pool_advice`.
-
Others solutions include:
  • Reducing the value of `→ development/databases/Oracle/adminstration/init-parameters/session/cached/cursors`
  • Reducing the value of `cursor_space_for_time`

{ Getting a snapshot of the shared pool when the error occurs

  Oracle creates a trace file in the ADR (or `user_dump_dest` before 11g) directory.

  { Before Oracle 9.2.0.5

  Possible values for level seem to be 1, 2, 3 or 32.
code {
alter session set events '4031 trace name errorstack level 3';
code }

  Adding 536870912 to the level will generate the 5 largest supheaps *and* the 5 largest heap areas within each of those.
code {
alter session set events '4031 trace name heapdump level 536870914';
code }

  }

}

sa:

  While ORA-04031 indicates a problem in the → development/databases/Oracle/architecture/instance/SGA,
  the error message → development/databases/Oracle/errors/ORA-out-of-process-memory-when-trying-to-allocate_bytes is related to a similar problem for the → development/databases/Oracle/architecture/instance/PGA.

  → development/databases/Oracle/architecture/instance/SGA/Shared-Pool#ora-shared-pool-alloc-mem[Shared pool heap manager: allocation memory].

  → development/databases/Oracle/errors[Other Oracle error messages]
