$ System Change Number (SCN)
@ SCN

The maximum possible value for an SCN (as of → development/databases/Oracle/Releases-and-versions/19c) is 281,474,976,710,656. This is 281 trillion.

{ Views where the SCN is found

  In the → development/databases/Oracle/installed/dynamic-performance-views[dynamic performance views (`v$…`)] and the
  → development/databases/Oracle/installed/data-dictionary[data dictionary], the columns that store SCNs seem to have the form `%CHANGE%#`. Thus, they can be queried with
code {
select distinct
   viw.view_name,
   viw.column_name,
-- viw.table_name,
   com.comments
from (
    select 
       col.owner,
       regexp_replace(
       regexp_replace(
       regexp_replace(col.table_name, '^AWR_[CP]DB_', 'AWR_xDB_')
                                    , '^G?V_\$'     , 'V$'      )
                                    , '^(DBA|CDB)_' , 'DBA_'    ) view_name,
       col.table_name,
       col.column_name
   from
      dba_tab_columns col  join
      dba_objects     obj on col.owner      = obj.owner      and
                             col.table_name = obj.Object_name
   where
      obj.object_type not in ('SYNONYM') and
      col.column_name like '%CHANGE%#'
)                  viw                                left join
dba_col_comments   com on viw.owner       = com.owner       and 
                          viw.table_name  = com.table_name  and
                          viw.column_name = com.column_name
order by
   viw.view_name,
   viw.column_name
code }

}

{ Queries

  { The SCN in v$database

code {
select CURRENT_SCN from → development/databases/Oracle/installed/dynamic-performance-views/database[v$database];
code }

  }
  { Find the SCN in the fixed tables
   

    The current value of the SCN can also be found in x$ tables.

    First, we need to get the address of the memory location where the SCN is stored. `x$ksmfsv` ehibits a list of pointers that point to values.
    We're interested in `kcsgscn_`:
code {
select
   addr                                      addr_of_pointer,
   ksmfsadr                                  addr_of_SCN_value_hex,
   to_number(ksmfsadr, rpad('x', 16, 'x'))   addr_of_SCN_value_int,
   ksmfssiz,
   ksmfstyp
from
   x$ksmfsv  fixed_variables
where
   ksmfsnam = 'kcsgscn_' -- SCN
;
code }

   With this address, we can query `x$ksmmmem` which gives direct access to the memory of the → development/databases/Oracle/architecture/instance/SGA/fixed:
code {
select
   to_number(ksmmmval, 'XXXXXXXXXXXXXXXX') as current_scn
from
   x$ksmmem
where
   addr=hextoraw('00007FF718801D20');
code }

   I wanted to join these two → development/databases/Oracle/SQL/select[`select` statements] but the join crashed the session.

   The SCN is also exposed in `x$kccdi` (kernel cache database information?), the same fixed table that also `v$database` queries from:
code {
select
   dicur_scn as current_SCN
from
   x$kccdi;
code }

  }
  { Use oradebug

    With → development/databases/Oracle/tools/oradebug, the value of the SCN might be found like so
code {
oradebug → development/databases/Oracle/tools/oradebug/setmypid[setmypid]
oradebug → development/databases/Oracle/tools/oradebug/dumpvar[dumpvar] → development/databases/Oracle/architecture/instance/SGA[sga] kcsgscn
code }

  }

}


sa:
  → development/databases/Oracle/architecture/transaction/SCN/checkpoint[Checkpoint SCN]
