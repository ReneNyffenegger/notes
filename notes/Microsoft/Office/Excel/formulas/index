$ Excel formulas
@ formula

An *→ Microsoft/Office/Excel[Excel] formula* starts with an equal sign (`=`), a plus (`+`) or a minus (`-`).

A formula contains a combination of
  • constants
  • cell references
  • → Microsoft/Office/Excel/functions[functions]
  • operators
  • … (?)


{ Display formula text

  { Switch between formula text mode and formula result mode

   *ctrl+`* (gravis) switches between displaying formula-text and formula-result.

    If in *show formula text* mode, the resulting value of a specific formula can be shown by pressing `F2` on the cell with the formula.

  }
  { Worksheet function formulaText

    The → Microsoft/Office/Excel/functions[worksheet function] `formulaText(ref)` returns the formula in the → Microsoft/Office/Excel/Object-Model/Range/cell `ref`. If there is no formula,
    it evaluates to → Microsoft/Office/Excel/data-types/error[`#NA`].

  }

}
{ Operators

  { Range operator

    The range operator is the *colon*. It produces a range with the cells between the addresses on its left and right side.

?   TODO: `application.range` seems to correspond to the colon operator.

  }
  { Intersect operator #excel-intersect-operator

    The intersect operator is a *space*. It evaluates to the range that is common to both ranges on its left and right side.

    Thus, It is possible to write formulas such as the following which
    calculates the sum of the number in `F10:F12`
code {
=sum(F9:F12 F10:F15)
code }

    An intersection that returns an empty set is shown with the → Microsoft/Office/Excel/Object-Model/Range/cell/errors[`#NULL!` cell error].

    See also the → Microsoft/Office/Excel/Object-Model/Application/set-operations[set operators] in the → Microsoft/Office/Excel/Object-Model/Application[`application`] object.

  }
  { Union operator #excel-union-operator

    The union operator is the *comma*. It evaluates to the range that is present on any of the ranges on its left or right side.

  }

}
{ Recalculation #excel-formula-recalculation

  → Microsoft/Office/Excel#excel-key-shortcut[Keyboard shortcuts] around `F9` can be used to perform or force recalculation of Excel formulas:
  table { lll
    ~Shortcut~         ☰ ~Description~ ☰ ~→ development/languages/VBA equivalent~
    `F9`               ☰ calculates all → Microsoft/Office/Excel/Object-Model/Worksheet[worksheets] in all open → Microsoft/Office/Excel/Object-Model/Workbook[workbooks] ☰
    `shift+F9`         ☰ calculates the active → Microsoft/Office/Excel/Object-Model/Worksheet[worksheet] ☰ `activeSheet.calculate` (?)
    `ctrl+alt+F9`      ☰ *forces* the recalculation in all worksheets of open workbooks, *even* if Excel thinks they have not changed ☰ `application.calculateFullRebuild` (?)
    `ctr+alt+shift+F9` ☰ calculates dependent → Microsoft/Office/Excel/Object-Model/Range/cell[cell] ☰
  table }

  Additional VBA functions (that might be related to these keyboard shortcuts) are:
     • `activeWorkbook.calculate`
     • `application.calculateFull`


  The corresponding → development/languages/VBA[VBA] method is → Microsoft/Office/Excel/Object-Model/Worksheet#excel-worksheet-calculate[`calculate`] (on a → Microsoft/Office/Excel/Object-Model/Worksheet[`Worksheet`] object).

  See also the → Microsoft/Office/Excel/Object-Model/Application#excel-application-calculation[`calculation`] property of the
  → Microsoft/Office/Excel/Object-Model/Application[`application`] object.
  -
  The → Microsoft/Office/Excel/functions[worksheet function] `info("recalc")` evaluates to the current mode of recalculation.
  
}

sa:

  With → development/languages/VBA, it is possible to dynamically evaluate a formula with → Microsoft/Office/Excel/Object-Model/Application#excel-application-evaluate[`application.evaluate(formula)`]

  → Microsoft/Office/Excel/formulas/array[Array formulas]

  The → Microsoft/Office/Excel/functions[worksheet function] `isFormula()`

  → Microsoft/Office/Excel/formulas/circular-reference[Circular references]
