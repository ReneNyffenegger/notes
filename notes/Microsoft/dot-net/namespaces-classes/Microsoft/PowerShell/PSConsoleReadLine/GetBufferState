$ Microsoft.PowerShell.PSConsoleReadLine: GetBufferState

code {
set-psReadLineKeyHandler 'alt-,' {
   [string] $line = ''
   [int]    $pos  = 0
   [Microsoft.PowerShell.PSConsoleReadLine]::GetBufferState([ref] $line, [ref] $pos)


   if ($line -eq 'getpos') {
      [Microsoft.PowerShell.PSConsoleReadLine]::Replace(0, 6, "The position of the cursor is $pos")
   }

}
code }
 
