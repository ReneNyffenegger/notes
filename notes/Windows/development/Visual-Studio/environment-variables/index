$ Visual Studio: environment variables

The environment variables are set by the → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Auxiliary/Build#vcvars_bat[`vcvars32.bat` and `vcvars64.bat`]
→ Windows/cmd-exe/batch-files[batch files].
-
The location of these files is in the directory [`%VCINSTALLDIR%/Auxiliary/Build`] - however, the environment variable `%VCINSTALLDIR%` will be set by these batch files, thus we have a typical
*schwanzbeisser* (a catch-22).

See also the `vcvarsall.bat` in that directory.


{ PATH

  The following directories are added to `%PATH%`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version/bin[%VSxxxCOMNTOOLS%\MSVC\%VCToolsVersion%\bin]\HostX{86\x86,64\x64}`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/IDE/VC/vcpackages[%VCIDEInstallDir%\VCPackages]`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/IDE/CommonExtensions/Microsoft/TestWindow[%VCDevEnvDir%\CommonExtensions\Microsoft\TestWindow]`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/IDE/CommonExtensions/Microsoft/TeamFoundation/Team-Explorer[%VCDevEnvDir%\CommonExtensions\Microsoft\TeamFoundation\Team Explorer]`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/MSBuild/x_y/bin[%VSINSTALLDIR%]\MSBuild\15.0\bin]`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/MSBuild/x_y/bin/Roslyn[%VSINSTALLDIR%\MSBuild\15.0\bin\Roslyn]`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Team-Tools/Performance-Tools[%VSINSTALLDIR%\Team Tools\Performance Tools]`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Team-Tools/Performance-Tools[%VSINSTALLDIR%\Team Tools\Performance Tools\x64`]  (*Only in 64 bit environment*)
  • → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/Shared/Common/VSPerfCollectionTools[`C:\Program Files (x86)\Microsoft Visual Studio\Shared\Common\VSPerfCollectionTools\`]
  • `C:\Program Files (x86)\Microsoft Visual Studio\Shared\Common\VSPerfCollectionTools\\x64` (*Only in 64 bit environment*)
  • `→ Windows/dirs/Program-Files-x86/Microsoft-SDKs/Windows/version/bin/NETFX-version-Tools[%WindowsSDK_ExecutablePath_x86%\]` (x64 ?)
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n/bin/version[%WindowsSdkVerBinPath%]x{86,64}`
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n/bin[%WindowsSdkDir%\bin]\x{86,64}`
  • C:\Windows\Microsoft.NET\Framework{,64}\v4.0.30319
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/IDE[%DevEnvDir%]`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/Tools[%VSxxxCOMNTOOLS%]`

  The `__VSCMD_PREINIT_PATH` variable contains the value of `%PATH%` it had prior to adding the Visual Studio variables.
}
{ INCLUDE

  These directories are added to the `%INCLUDE%` variable:
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version[%VCToolsVersion%]\ATLMFC\include`
  • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version/include[%VSxxxCOMNTOOLS%\MSVC\%VCToolsVersion%\include]`
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n[%WindowsSdkDir%]\NETFXSDK\4.6.1\include\um`
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n/Include/version[%UniversalCRTSdkDir%/Include/%UCRTVersion%]\ucrt`
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n/Include/version[%UniversalCRTSdkDir%/Include/%UCRTVersion%]\shared`
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n/Include/version[%UniversalCRTSdkDir%/Include/%UCRTVersion%]\um`
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n/Include/version[%UniversalCRTSdkDir%/Include/%UCRTVersion%]\winrt`
  • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n/Include/version[%UniversalCRTSdkDir%/Include/%UCRTVersion%]\cppwinrt`

  The `INCLUDE` directories are not dependent on the 86,64 environment.

}
{ LIB

   These directories are added to the `LIB` variable:
    • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version/%VSxxxCOMNTOOLS%\MSVC\%VCToolsVersion%]\ATLMFC\lib\{x86,x64}`
    • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version/lib[%VSxxxCOMNTOOLS%\MSVC\%VCToolsVersion%\lib]\{x86,x64}`
    • `C:\Program Files (x86)\Windows Kits\NETFXSDK\4.6.1\lib\um\{x86,x64}`
    • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n[%WindowsSdkDir%]\lib\%UCRTVersion%\ucrt\{x86,x64}`
    • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n[%WindowsSdkDir%]\lib\%UCRTVersion%\um\{x86,x64}`

}
{ LIBPATH

  These directories are added to the `LIBPATH` variable:
    • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version[%VSxxxCOMNTOOLS%\MSVC\%VCToolsVersion%]\ATLMFC\lib\{x86,x64}`
    • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version[%VSxxxCOMNTOOLS%\MSVC\%VCToolsVersion%]\lib\{x86,x64}`
    • `→ Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version[%VSxxxCOMNTOOLS%\MSVC\%VCToolsVersion%]\lib\x86\store\references`  (*No difference in 86 and 64 environment. Error in batch file? *)
    • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n[%WindowsSdkDir%]\UnionMetadata\%UCRTVersion%`
    • `→ Windows/dirs/Program-Files-x86/Windows-Kits/n[%WindowsSdkDir%]\References\%UCRTVersion%`
    • `→ Windows/dirs/Windows/Microsoft_NET/Framework[%SystemRoot%\Microsoft.NET\Framework]{,64}\%FrameworkVersion%`   (*Note: 86 environment without 86 in path name.*)
}
{ Directories

  Variables that specify specific directories.

table { lll

  ~Variable~                     ☰ ~Possible value~ ☰ ~Comment~
   VSINSTALLDIR                  ☰ → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition[`C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\`] ☰ Note the similarity to `%VCINSTALLDIR%`
   VCINSTALLDIR                  ☰ → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC[`%VSINSTALLDIR%VC\`] ☰  The `VC` directory below `%VSINSTALLDIR%`.
   VSxxxCOMNTOOLS                ☰ → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/Tools[`%VSINSTALLDIR%Common7\Tools\`] ☰ 
   DevEnvDir                     ☰ → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/IDE[`%VSINSTALLDIR%Common7\IDE\`] ☰ 
   VCIDEInstallDir               ☰ → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/Common7/IDE/VC[`%DevEnvDir%VC`] ☰ 
   VCToolsInstallDir             ☰ → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Tools/MSVC/version[`%VCINSTALLDIR%Tools\MSVC\%VCToolsVersion%\`] ☰ 
   VCToolsRedistDir              ☰ → Windows/dirs/Program-Files-x86/Microsoft-Visual-Studio/version/edition/VC/Redist/MSVC/version[`%VCINSTALLDIR%Redist\MSVC\%VCToolsVersion%\`] ☰ 
   FrameworkDir32                ☰ → Windows/dirs/Windows/Microsoft_NET/Framework[`C:\Windows\Microsoft.NET\Framework\`] ☰ 
   FrameworkDir64                ☰ → Windows/dirs/Windows/Microsoft_NET/Framework64[`C:\Windows\Microsoft.NET\Framework64\`] ☰ 
   UniversalCRTSdkDir            ☰ → Windows/dirs/Program-Files-x86/Windows-Kits/n[`C:\Program Files (x86)\Windows Kits\10\`] ☰ 
   WindowsSdkDir                 ☰ → Windows/dirs/Program-Files-x86/Windows-Kits/n[`C:\Program Files (x86)\Windows Kits\10\`] ☰ 
   WindowsSdkBinPath             ☰ → Windows/dirs/Program-Files-x86/Windows-Kits/n/bin[`%WindowsSdkDir%bin`] ☰ 
   WindowsSdkVerBinPath          ☰ → Windows/dirs/Program-Files-x86/Windows-Kits/n/bin/version[`%WindowsSdkDir%bin\%WindowsSDKVersion%\`] ☰ 
   WindowsLibPath                ☰ `%WindowsSdkDir%\UnionMetadata\10.0.17763.0;%WindowsSdkDir%\References\10.0.17763.0` ☰ 
   ExtensionSdkDir               ☰ `→ Windows/dirs/Program-Files-x86/Microsoft-SDKs[C:\Program Files (x86)\Microsoft SDKs]\Windows Kits\10\ExtensionSDKs` ☰ 
   WindowsSDK_ExecutablePath_x64 ☰ C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6.1 Tools\x64\ ☰ 
   WindowsSDK_ExecutablePath_x86 ☰ → Windows/dirs/Program-Files-x86/Microsoft-SDKs/Windows/version/bin/NETFX-version-Tools[`C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6.1 Tools\`] ☰ 

  table }

}

{ Version numbers

  table { ll

  ~Variable name~                ☰ ~Possible value~
   Framework40Version            ☰ v4.0
   FrameworkVersion              ☰ v4.0.30319
   FrameworkVersion32            ☰ v4.0.30319
   FrameworkVersion64            ☰ v4.0.30319
   UCRTVersion                   ☰ 10.0.17763.0
   VSCMD_VER                     ☰ 15.9.7
   → Windows/development/Visual-Studio/versions[VisualStudioVersion] ☰ 15.0
   VCToolsVersion                ☰ 14.16.27023
   WindowsSDKVersion             ☰ 10.0.17763.0\
   WindowsSDKLibVersion          ☰ 10.0.17763.0\

 table }

   The `%FrameworkVersion%` variables seem to be used to locate the → Windows/dirs/Windows/Microsoft_NET/Framework64/version[`%SystemRoot%\Microsoft.NET\Framework64\%FrameWorkVersion64%`] directory.

}
{ Environment dependent

  Variables that are dependent on the target-bitness

table { lll

   ~Variable~                  ☰ ~env 32 value~ ☰ ~env 64 value~
    Platform                   ☰ x86   ☰ x64
    FrameworkDir               ☰ C:\Windows\Microsoft.NET\Framework\ ☰ FrameworkDir=C:\Windows\Microsoft.NET\Framework64\
    VSCMD_ARG_HOST_ARCH        ☰ x86    ☰ x64
    VSCMD_ARG_TGT_ARCH         ☰ x86    ☰ x64
    __DOTNET_PREFERRED_BITNESS ☰ 32     ☰ 64
    __DOTNET_ADD_32BIT         ☰ 1      ☰ *n/a*
    __DOTNET_ADD_64BIT         ☰ *n/a*  ☰ 1

table }
}
{ Others

  table { ll

  ~Variable name~       ☰ ~Possible value~
   CommandPromptType    ☰ Native
   VSCMD_ARG_app_plat   ☰ Desktop

  table }

}


