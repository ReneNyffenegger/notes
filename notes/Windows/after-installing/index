$ After installing Windows
-

{ Change execution policy of PowerShell


  Change the value of `ExecutionPolicy` under
  → Windows/registry/tree/HKEY_CURRENT_USER/Software/Microsoft/PowerShell/1/ShellIds/Microsoft_PowerShell[`HKEY_CURRENT_USER\Software\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell`]
  in order to be able to run → Windows/PowerShell[PowerShell] scripts and not receive error
  → Windows/PowerShell/script-cannot-be-loaded-because-running-scripts-is-disabled-on-this-system[script cannot be loaded because running scripts is disabled on this system] anymore.


}
{ Check default values in registry

  → Windows/registry/tree/HKEY_LOCAL_MACHINE/Software/RegisteredApplications#reg-registeredApplications-default[`HKEY_LOCAL_MACHINE\SOFTWARE\RegisteredApplications`]

}
{ Create bin directory

  Create a `bin` directory under → Windows/dirs/Users/username[`%UserProfile%`] to store execetables and scripts so that they can be called from the command line (such as → Windows/cmd-exe[cmd.exe] or PowerShell).
  -
  With → Windows/PowerShell[PowerShell]:
code {
$binPath = "$env:userprofile\bin"
mkdir $binPath
code }

  Add the newly created directory to the `PATH` → development/environment-variable[environment variable]:
code {
$userPath = [environment]::getEnvironmentVariable("PATH", "user"    )
[environment]::setEnvironmentVariable("PATH", "$binPath;$userPath", "user") 
code }


}
{ Download Sysinternal tools

  → Windows/tools/Sysinternals#download[Download] interesting → Windows/tools/Sysinternals tools and → Windows/tools/Sysinternals#accept-eula[accept their EULA].

  2019-03-02: It turns out that at least → Windows/tools/Sysinternals/Procmon[Procmon] comes with the command line option `/AcceptEula` which does that, too.

}

{ Activate Administrator account

  Check current accounts (`wmic useraccount`) and → Windows/registry/tree/HKEY_USERS[`HKEY_USERS`].

  In → Windows/cmd-exe[cmd.exe].
code {
C:\> wmic useraccount where (name='administrator' and domain='%computername%') get name,sid
code }

  Activate and/or enable the administrator → Windows/user-account[account] and assign a password
code {
c:\> → Windows/cmd-exe/commands/net/user[net user] administrator /active:yes
c:\> → Windows/cmd-exe/commands/net/user[net user] administrator MYSECRETPASSWORD
code }

}
{ TODO

  How do I determine if I started → Windows/PowerShell as Administrator?
  -
  Try `→ Windows/dirs/Windows/System32/whoami_exe[whoami] /priv`.


  Install → Windows/development/Visual-Studio and add `/nologo` to the `CL` and `LINK` → development/environment-variable[environment variables].

  What is a users logon id (`→ Windows/dirs/Windows/System32/whoami_exe[whoami /logonid]`)?

  Create → Windows/PowerShell[PowerShell] profile
code {
if ( -not ( test-path $profile ) ) {

   write-output "$profile does not exist. Creating it"
   new-item -itemType file -path $profile -force


}
else {

   write-output "$profile already exists"

}
code }

  Copy → https://github.com/ReneNyffenegger/scripts-and-utilities/blob/master/profile.ps1[`profile.ps`] to profile path `$profile`.

  Which → Windows/development/process[processes] are seen to run after installation?
    • → Windows/dirs/Windows/System32/audiodg_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/ApplicationFrameHost_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/backgroundTaskHost_exe
    • → Windows/dirs/Windows/System32/browser_broker_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • CCC.exe (ATI?)
    • → Windows/dirs/Windows/System32/csrss_exe
    • → Windows/dirs/Windows/System32/ctfmon_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/dllhost_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/dwm_exe (Child of → Windows/dirs/Windows/System32/winlogon_exe)
    • → Windows/dirs/Windows/explorer_exe
    • SkypeApp.exe
    • SkypeAppBackgroundHost.exe
    • → Windows/dirs/Windows/System32/fontdrvhost_exe
    • Interrupts (handling *hardware interrupts and DPCs, child of *System* process
    • → Windows/dirs/Windows/System32/lsass_exe
    • Memory Compression (Child of *System* process)
    • → Windows/dirs/Program-Files/Windows-Defender/MSASCuiL_exe
    • MOM.exe (ATI?)
    • → Windows/dirs/ProgramData/Microsoft/Windows-Defender/Platform/_version_/MsMpEng_exe
    • → Windows/dirs/ProgramData/Microsoft/Windows-Defender/Platform/_version_/NisSrv_exe
    • OneDrive.exe (why…?)
    • Registry
    • → Windows/dirs/Windows/System32/RuntimeBroker_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/SearchFilterHost_exe
    • → Windows/dirs/Windows/System32/SearchIndexer_exe (Parent process of → Windows/dirs/Windows/System32/SearchProtocolHost_exe and SearchFilterHost.exe)
    • → Windows/dirs/Windows/System32/SearchProtocolHost_exe
    • → Windows/dirs/Windows/SystemApps/Microsoft_Windows_Cortana_cw5n1h2txyewy/SearchUI_exe
    • → Windows/dirs/Windows/System32/smartscreen_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/smss_exe (The first *user mode* process, child of *System* process)
    • → Windows/dirs/Windows/System32/spoolsv_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/taskhostw_exe
    • → Windows/dirs/Program-Files/rempl/sedlauncher_exe
    • → Windows/dirs/Windows/System32/SecurityHealthService_exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/services_exe (Parent process of quite a few → Windows/dirs/Windows/System32/svchost_exe[`svchost.exe`] processes)
    • SgmBroker.exe
    • → Windows/dirs/Windows/System32/sihost_exe
    • ShellExperienceHost.exe (Child of a → Windows/dirs/Windows/System32/svchost_exe)
    • → Windows/dirs/Windows/System32/svchost_exe (all of which seem to be a child process of → Windows/dirs/Windows/System32/services_exe[`services.exe`])
    • System (always with PID = 4?)
    • System Idle Process
    • → Windows/dirs/Windows/System32/wininit_exe (Parent process of → Windows/dirs/Windows/System32/services_exe, → Windows/dirs/Windows/System32/lsass_exe and → Windows/dirs/Windows/System32/fontdrvhost_exe)
    • → Windows/dirs/Windows/System32/winlogon_exe
    • → Windows/dirs/Windows/System32/wbem/wmiprvse_exe
    • → Windows/dirs/Windows/System32/wsqmcons_exe
    • → Windows/dirs/Windows/System32/WWAHost_exe

  Which → Windows/services[services] are installed?

  Which programs do *autorun*?
  -
  What about `HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Winlogon`, value of `ParseAutoexec`?

  Where does Sysinternals's Process Monitor store its settings?

  Copy → https://github.com/ReneNyffenegger/scripts-and-utilities/blob/master/profile.ps1[`profile.ps`] to profile path `$profile`.

  → Windows/registry/tree/HKEY_CURRENT_USER/Software/Microsoft/Windows/CurrentVersion/Explorer/Advanced#reg-show-hidden-files-and-extensions

  → Windows/registry/tree/HKEY_CURRENT_USER/Software/Microsoft/Internet-Explorer/Main#reg-iexplorer-change-start-page[Changing the start page] of
  → development/web/browser/Internet-Explorer[Internet Explorer] (respectively
  → Windows/registry/tree/HKEY_CLASSES_ROOT/Local-Settings/Software/Microsoft/Windows/CurrentVersion/AppContainer/Storage/microsoft-microsoftedge_8wekyb3d8bbwe/MicrosoftEdge/Main#reg-edge-startpage[that of Edge]).


  Remove unnecessary directories under → Windows/dirs/Users/username[`%UserProfile%`].

  Activate Windows
  -
  Does it have something to do with `changepk.exe` (under → Windows/dirs/Windows/System32)?
  -
  Can it be done with → Windows/dirs/Windows/System32/slmgr_vbs[`slmgr.vbs`]? Possibly with the `/ato` option?

  What is auto-run? Why is *OneDrive.exe* started?

→ Windows/registry/tree/HKEY_LOCAL_MACHINE/System/CurrentControlSet/FileSystem#reg-long-paths[Enable long file paths]

Swap keys

→ development/vim/compiling[Compile and install vim]
-
Then try to install winpty (`:help :terminal`)

→ Windows/cmd-exe[cmd.exe]: check values under → Windows/registry/tree/HKEY_CURRENT_USER/Software/Microsoft/Command-Processor[`HKEY_CURRENT_USER\Software\Microsoft\Command Processor`], particularly
`CompletionChar`, `PathCompletionChar` and `EnableExtensions`.

Install → development/version-control-systems/git[git]

Install → https://www.howtogeek.com/249966/how-to-install-and-use-the-linux-bash-shell-on-windows-10/[bash]

Can *Cortana* be turned off/disabled?

  → Windows/registry/tree/HKEY_CURRENT_USER/Software/Microsoft/Windows/CurrentVersion/Explorer/VisualEffects[`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects`],
  → Windows/registry/tree/HKEY_CURRENT_USER/Software/Microsoft/Windows/DWM[`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\DWM`] and
  → Windows/dirs/Windows/System32/SystemPropertiesAdvanced_exe

  Enable → Windows/registry/tree/HKEY_CURRENT_USER/Control-Panel/Input-Method#reg-EnableHexNumpad[entering Unicode characters].

}
