$ reg.exe

*→ Windows/registry[Registry] console tool*: `reg.exe` allows to query the → Windows/registry[registry] or set values in the registry from → Windows/dirs/Windows/System32/cmd_exe[cmd.exe] or
→ Windows/PowerShell[PowerShell]

{ Writing a value int the registry

code {
c:\> reg add HKCU\path\to\key /v nameOfValue /t dataType /d value /f 
code }

dataType is one of
  • `REG_DWORD`
  • `REG_QWORD`
  • `REG_SZ`
  • `REG_MULTI_SZ` (which seems to be the utf-16 / → development/Unicode variant of `REG_SZ`)
  • `REG_EXPAND_SZ`
  • `REG_BINARY`
  • `REG_NONE` (?)

}
{ Querying a specific value in the registry

  → Windows/dirs/Windows/System32/reg_exe/query[`req query`] in combination with `/v` can be used to query for a specific value under a specific key in the → Windows/registry[registry].

  The following command determines the (system wide) value of the `PATH` → development/environment-variable[environment variable].

code {
reg query → Windows/registry/tree/HKEY_LOCAL_MACHINE/System/CurrentControlSet/Control/Session-Manager/Environment["HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment"] /v PATH
code }

  Unfortunately, `reg query` also prints the key and data type of the queried value. In order to only print the value, the `reg query` might be combined with
  → Windows/dirs/Windows/System32/cmd_exe/commands/for/f/tokens[`for /f "tokens=…"`] to extract the value only. On the command line, that would be:
code {
for /f "tokens=2,* skip=2" %a in ('reg query "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" /v TEMP') do echo %b
code }

  If this construct is used in a *batch file*, the percent signs need to be doubled (`%%a` and `%%b` instead of `%a` and `%b`), see
  for example → development/tools/scripts/personal/regQuery_bat[`regQuery.bat`].
  
}
{ Recursively search for a specific values

  `reg query … /s` allows to recursively search for a specific value under a given key.

   The following command searches for any key (`/k`) under → Windows/registry/tree/HKEY_LOCAL_MACHINE/Software/Classes[`HKLM\SOFTWARE\Classes`] whose name contains *key-value*. 

code {
reg query HKLM\SOFTWARE\Classes /k /f key-value
code }

  If the search is to be restricted to values that contain a specific value, `/d` instead of `/k` should be used.

  The ~asterisk~ (star) is recognized as a *wild card*.
  -
  The following example searches for all values that end in `.wav` under → Windows/registry/tree/HKEY_CURRENT_USER/AppEvents/Schemes[`HKEY_CURRENT_USER\AppEvents\Schemes`]:
code {
C:\> reg query HKEY_CURRENT_USER\AppEvents\Schemes /s /d /f "*.wav"
code }

}
{ Escaping special characters #reg-escape

  Apparently, apostrophes can be escaped with a backslash and percent signs can be escaped with a caret (`^`).

}


sa:

 → Windows/registry/regedit, → Windows/registry

 → Windows/dirs/Windows/System32/regini_exe[`regini.exe`]

