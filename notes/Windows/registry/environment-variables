$ Registry: environment variables

There seem to be four places that control the values of → development/environment-variable[environment variables]:
  • → Windows/registry/tree/HKEY_CURRENT_USER/Environment[`HKEY_CURRENT_USER\Environment`]
  • → Windows/registry/tree/HKEY_LOCAL_MACHINE/System/CurrentControlSet/Control/Session-Manager/Environment[`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment`]
  • → Windows/registry/tree/HKEY_LOCAL_MACHINE/Software/Microsoft/Windows/CurrentVersion/App-Paths[`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\App Paths`]


{ WM_SETTINGCHANGE

  After changing the value of an → development/environment-variable[environment variable], the system should be notified with sending the `WM_SETTINGCHANGE` message using the
  → Windows/development/WinAPI[WinAPI] function `SendMessage`, having `lParam` set to the string `"Environment"`.

  In → development/languages/VBA[Visual Basic for Applications], this can be achieved with the following call. The declaration of the function and constants
  is found → development/languages/VBA/Win-API[here].

code {
call SendMessageW(HWND_BROADCAST, WM_SETTINGCHANGE, 0, byVal → development/languages/VBA/functions/xPtr[strPtr](txt))
code }

}
