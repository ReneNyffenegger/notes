$ Registry: HKEY_CLASSES_ROOT\Local Settings\Software\Microsoft\Windows\Shell

{ Shell bags

  The purpose of *Shell bags* is to store the information about the sizes and positions of the shell windows (that is → Windows/dirs/Windows/explorer_exe[`explorer.exe`] and its views.

  Two subkeys seem to play an important role:
    • → Windows/registry/tree/HKEY_CLASSES_ROOT/Local-Settings/Software/Microsoft/Windows/Shell/Bags[Bags]
    • → Windows/registry/tree/HKEY_CLASSES_ROOT/Local-Settings/Software/Microsoft/Windows/Shell/BagMRU[BagMRU]

  Tools: RegRipper, sbags, ShellBags Explorer/SBECmd

}

links:

  SA Eric R. Zimmerman: → https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1492184337.pdf[Plumbing the Depths: ShellBags]

  Willi Ballenthin: → http://www.williballenthin.com/forensics/shellbags/[Windows Shellbag Forensics]

  Microsoft's → https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc[Property Store Binary File Format]

  → https://web.archive.org/web/20180427090821/http:/www.4n6k.com/2013/12/shellbags-forensics-addressing.html


