<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>VBA Module 00_ModuleLoader [Common]</title>
<link rel="stylesheet" type="text/css" href="file:///home/rene/github/github/notes/out.html//notes.css">
<script src='file:///home/rene/github/github/notes/out.html//q.js'></script>
</head>
<body>
Search notes: <input size='50' id='q' onchange='q();'>
<h1>VBA Module 00_ModuleLoader [Common]</h1>
<div class='t'>
</div><div class='ghf'>Github respository <a href='https://github.com/ReneNyffenegger/VBAModules'>VBAModules</a>, path: <a href='https://github.com/ReneNyffenegger/VBAModules/blob/master//Common/00_ModuleLoader.bas'>/Common/00_ModuleLoader.bas</a></div><pre class='code'>'
'
'   1   Create a module, copy paste content of this file into new module
'
'   2   In «Immediate Window» (german: «Direktfenster») to be found under Menu «View» (german: «Ansicht»)
'       or using Ctrl-G) , first do
'          call application.VBE.activevbProject.references.addFromGuid ("{0002E157-0000-0000-C000-000000000046}", 5, 3)

'   2a  Optionally, you might want to rename the newly inserted module
'      (Still in the «immediate window»:
'          vbe.Activevbproject.VBComponents(1).Name = "00_ModuleLoader"
'
'   3   Then load the modules by calling
'          call loadOrReplaceModuleWithFile("fooModule", "c:\path\to\modFoo.bas")
'       for each module
'

option explicit

sub loadOrReplaceModuleWithFile(moduleName as string, pathToFile as string) ' {

    dim mdl   as module
    dim vbc   as vbComponents
    dim i     as long
    dim found as boolean

    set vbc = application.VBE.activeVBProject.vbComponents

    found = false

    for i = 1 to vbc.count
        if  vbc(i).name = moduleName then
            found = true
            exit for
        end if
    next i

    if found then
       call vbc.remove(vbc(i))
    end if

    call loadMOduleFromFile(moduleName, pathToFile)

end sub ' }

sub loadMOduleFromFile(moduleName as string, pathToFile as string) ' {

    dim vbComp as vbComponent
    set vbComp = application.VBE.activeVBProject.vbComponents.import(pathToFile)

    vbComp.name  = moduleName

'   Doesn't work, unfortunately
'   vbComp.saved = true 

'   Neither does this
'      (Run-time error 29068: Microsoft Access cannot complete this operation
'       You must stop the code and try again)
'   doCmd.save acModule, moduleName

'   This does not generate a runtime error, but
'   does not seem to save the module, either:
    doCmd.close acModule, moduleName, acSaveYes

end sub ' }
</pre><div class='t'> </div>
<div class='h'><h2>See also</h2>
<div class='t'>
  <a href='file:///home/rene/github/github/notes/out.html//development/languages/VBA/modules/index.html'>VBA Modules</a> </div>
</div><hr><p><a href='file:///home/rene/github/github/notes/out.html//index.html'>Index</a><div class='bottom'></div></body>
</html>